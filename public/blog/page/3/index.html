
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Bird Stream</title>
  <meta name="author" content="Adam">

  
  <meta name="description" content="This was to be my first foray into UI integration testing. I&#8217;ve always been a sceptic, scare by the brittleness of any kind of recorded UI test &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://adambird.com/blog/page/3/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Bird Stream" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Bird Stream</a></h1>
  
    <h2>Software development, entrepreneurship and cycling, often simultaneously</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:adambird.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/ui-integration-testing-with-cassinidev-and-wa">UI Integration Testing With CassiniDev and WatiN, Not Selenium</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-30T20:56:00+01:00" pubdate data-updated="true">Sep 30<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This was to be my first foray into UI integration testing. I&#8217;ve always been a sceptic, scare by the brittleness of any kind of recorded UI test. Luckily Gemma and Jonathan in the dev team persisted and showed me Selenium RC and WatiN. Both these solutions allow you to write the integration tests in code, a critical requirement for me.</p>

<p>Also key for me was this had to work in Hudson, my chosen Continuous Integration server, so simple deployment and management was key. I love being able to check everything I need into source control and have it &#8216;miraculously&#8217; run on the CI server with little or no config.</p>

<p>The first thing I needed was a deployable web server I could, ideally, run in process. Enter <a href="http://cassinidev.codeplex.com/" title="CassiniDev" target="_blank">CassiniDev</a>&nbsp;and specifically the CassiniDev4-Lib.dll. Now this was really tricky to get going ;).</p>

<ol>
<li><p>Add reference to CassiniDev4-Lib.dll</p></li>
<li><p>Put following code in my TestFixtureSetup</p></li>
</ol>


<div class="CodeRay">
  <div class="code"><pre>_hostServer = new CassiniDevServer();
_hostServer.StartServer(@&quot;..\..\..\mywebapp&quot;);</pre></div>
</div>


<p>&nbsp;</p>

<p><a href="http://seleniumhq.org/" target="_blank">Selenium</a> wasn&#8217;t quite so simple.</p>

<p>It failed the simple deploy requirement because you have to run the Selenium Server and then use the RC libraries to interact with it and send commands to then run on browsers.</p>

<p>It also has/d a bug where it sends a HEAD before it sends a GET which breaks if your MVC Controller Action as an HttpGet attribute. It sends a 404 because HEAD isn&#8217;t acceptable.</p>

<p>Sky from the CassiniDev team was &uuml;ber-helpful finding this out for me&nbsp;<a href="http://cassinidev.codeplex.com/Thread/View.aspx?ThreadId=227174" target="_blank">http://cassinidev.codeplex.com/Thread/View.aspx?ThreadId=227174</a>.</p>

<p><a href="http://watin.sourceforge.net/" target="_self">WatiN</a> was a different story though. Very simple to use and all run in process. There were a couple of gotcha&#8217;s though.</p>

<p>I had to make sure NUnit was properly running .net 4, stackoverflow helped me there&nbsp;<a href="http://stackoverflow.com/questions/2635794/nunit-fail-with-system-argumentexception-the-net-4-0-framework-is-not-available" target="_blank">http://stackoverflow.com/questions/2635794/nunit-fail-with-system-argumentexception-the-net-4-0-framework-is-not-available</a></p>

<p>And I got a rather gruesome COM exception when I pushed it all up to my CI server.&nbsp;</p>

<div class="CodeRay">
  <div class="code"><pre>NSystem.UnauthorizedAccessException: Retrieving the COM class factory for component with
        CLSID {0002DF01-0000-0000-C000-000000000046} failed due to the following error: 
        80070005 Access is denied. (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED)).
    at WatiN.Core.IE.CreateNewIEAndGoToUri(Uri uri, IDialogHandler logonDialogHandler, 
        Boolean createInNewProcess)
    at WatiN.Core.IE..ctor(String url)</pre></div>
</div>


<p>Luckily I found this post that talks through setting the COM permissions correctly for this kind of issue. Specifically giving the correct permissions to the user account used by the Hudson server. <a href="http://www.stuffthatjustworks.com/How+To+Fix+UnauthorizedAccessException+Retrieving+The+COM+Class+Factory+For+Component+With+CLSID.aspx" target="_blank">How To Fix UnauthorizedAccessException Retrieving The COM Class Factory For Component With CLSID</a></p>

<p>Early days, but I now have a green build that includes actually navigating to one of my forms and entering text within an integration test.</p>

<p>Selenium seemed to be the obvious choice for UI testing. I read somewhere that Google is throwing loads of effort into developing it so it would be a good horse to back. However, when I look at my requirements I don&#8217;t need what Selenium offers.</p>

<p>Multi, cross-browser testing is nice but I&#8217;m just looking to confirm stories are operational and routes through my application are valid. The simplicity of WatiN seems to satisfy that nicely.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/aspnet-mvc2-wildcard-mapping-on-iis6">ASP.NET MVC2 Wildcard Mapping on IIS6</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-22T10:09:00+01:00" pubdate data-updated="true">Sep 22<span>nd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Spent a little while tearing my hair out on this one. I followed Steve Sanderson&#8217;s post ( <a href="http://blog.stevensanderson.com/2008/07/04/options-for-deploying-aspnet-mvc-to-iis-6/">http://blog.stevensanderson.com/2008/07/04/options-for-deploying-aspnet-mvc-t&#8230;</a> ) but I was still getting the classic IIS 404<img src="/images/aspnet-mvc2-wildcard-mapping-on-iis6/Capture_dcran_2010-09-22_10.02.png">
Finally found the answer in the Web Service Extensions section of IIS Manager. I had to enable the ASP.NET v4 extension</p>

<p><div class='p_embed p_image_embed'>
<img alt="0capture_dcran_2010-09-22_10" height="205" src="http://getfile2.posterous.com/getfile/files.posterous.com/adambird/MDvQ69C5ItPKEoB4kuMHKPCzWXJi4I0MxhPWWTm3jjWokINR6lokcYWbDQlN/0Capture_dcran_2010-09-22_10.02.png" width="486" />
</div>
</p>


<p>But just clicking Allow here didn&#8217;t work. I actually had to go to Properties > Required Files and Allow the aspnet_isapi.dll.</p>

<p><div class='p_embed p_image_embed'>
<img alt="1capture_dcran_2010-09-22_10" height="436" src="http://getfile6.posterous.com/getfile/files.posterous.com/adambird/eh52RV4z3yq4Yu0S0vgoYfCVzroU6kiczhVuZzYpp6Epkq5dcpgVI6lo2iXJ/1Capture_dcran_2010-09-22_10.02.png" width="402" />
</div>
</p>


<p>Sorted</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/one-of-my-favourite-features-of-the-new-offic">One of My Favourite Features of the New Office</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-09T09:39:11+01:00" pubdate data-updated="true">Sep 9<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/one-of-my-favourite-features-of-the-new-offic/photo.jpg"></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/office-coming-together">Office Coming Together</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-08T15:49:48+01:00" pubdate data-updated="true">Sep 8<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>A big few days to get it all done but we move in here on Monday. <p /> There&#8217;s no mistaking where you are.<img src="/images/office-coming-together/photo.jpg"></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/how-we-laughed">How We Laughed!!!</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-08T12:08:29+01:00" pubdate data-updated="true">Sep 8<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/how-we-laughed/photo.jpg"></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/a-dvcs-working-process">A DVCS Working Process</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-04T16:44:00+01:00" pubdate data-updated="true">Sep 4<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve started working with Git using <a href="http://github.com">GitHub</a> as a remote repository. This introduces into my life branching as a cheap operation and makes for a potentially different way of working.</p>

<p>After a discussion with the guys at work on Friday afternoon, here&#8217;s what I&#8217;ve come up with:</p>

<p>Start a new feature =&gt; start a new branch.</p>

<p><code>git branch master [feature branch name]</code></p>

<p>The master branch is preserved for the current release code. My <a href="http://www.hudson-ci.org">Hudson</a> instance is only monitoring that branch for changes and ignoring all other branches.</p>

<p>I then push the branch to my remote repository so I get the benefits of a back-up as well being able to share the branch if I need to collaborate with someone else on it in the future.</p>

<p><code>git push [remote repository address] [feature branch name]</code></p>

<p>The code rythym then becomes add files, commit to the branch and then push to the remote repo branch.</p>

<p>Once the feature is finished then it&#8217;s a case of squashing the commits on my local master branch and then pushing them to the remote copy.</p>

<p><code>git checkout master</code></p>

<p><code>git merge --squash [feature branch name]</code></p>

<p><code>git push</code></p>

<p>Then it&#8217;s just a case of deleting the feature branch when I&#8217;m happy it&#8217;s complete</p>

<p>Would appreciate any thoughts on this, does it sound sensible?</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/test-teams-are-pointless-and-counter-producti">Test Teams Are Pointless and Counter-productive</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-02T16:21:08+01:00" pubdate data-updated="true">Sep 2<span>nd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In an Agile world unit tests and integration tests, in our case driven <br />by BDD declared stories, are a fundamental part of a development <br />team&#8217;s output. It could be argued that this is the most important <br />element as these both prove the software works and document what it is <br />supposed to do. <p /> Coverage is key to the success of this. The developers need to ensure <br />their tests cover sufficient scenarios so as to ensure the software <br />delivers when used in anger. <p /> The traditional approach is to have a dedicated test team that checks <br />the code in isolation as developers &#8216;can&#8217;t be trusted&#8217; to do it <br />themselves. <p /> Personally I think this is balderdash. <p /> The test-team-as-gatekeeper approach encourages a lack of <br />responsibility in the development team. They can produce what they <br />like, safe in the knowledge that the test team will pick it up. And, <br />if they don&#8217;t, well they&#8217;re mainly to blame rather than the <br />developers. After all, they&#8217;re not testers. <p /> Far better to have developers engaged all the way to delivery and beyond. <p /> Pair programming, peer reviews and giving rapid iterations for the <br />customer to critique and break all ensure the coverage is complete. <br />But there is nothing like actually engaging with the user to really <br />bring home the importance of the feature being worked on or to bring <br />in to stark relief the usability assumptions they&#8217;ve made. <p /> So, death to test teams. There is no place for them in an agile world.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/premier-inn-getting-is-so-right">Premier Inn Getting It So Right</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-08-30T08:44:00+01:00" pubdate data-updated="true">Aug 30<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Stopped at the Premier Inn in Port Solent to break up the long drive back from France this weekend and am really glad we did. <p /> We arrived at the end of a long day of travelling which was made longer than expected by very slow progress getting off the ferry and through passport control. Incidentally the immigration officer was in fine spirits given the knackered and undoubtedly surly holiday makers he was encountering. <p /> The woman on reception at the hotel couldn&#8217;t do enough to help us: <p /> Parking was full so we were concerned about 4 bikes on the back of the car in the overflow car park - no problem we&#8217;ll put them in a meeting room for you. <br />We were too late for food from nearby restaurants - no problem, here&#8217;s a takeaway delivery menu <br />Takeaway won&#8217;t take our order because there isn&#8217;t a house number to go with the postcode - no problem, I&#8217;ll speak to them. <p /> The room was clean, a decent size with comfy beds. We all had a great nights sleep. <p /> Breakfast the next morning was busy so we had to wait for a table, the staff member suggested we help ourselves to coffee and juice while we waited on the reception seating. There were about 10 families waiting but there was enough seating and because of the progressive approach of making sure we all had a drink in our hands everyone was happy waiting. When we had breakfast the food was plentiful and decent enough quality. <p /> There were so many opportunities for the staff to turn our stay into a bit of a pain through going through the motions rather than helping. Instead every one of them were friendly, helpful and it worked wonders. We left refreshed, fed and pleased we&#8217;d stayed the night.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/do-androids-dream-of-electric-sheep">Do Androids Dream of Electric Sheep</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-08-27T20:22:00+01:00" pubdate data-updated="true">Aug 27<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Just finished reading this for the first time many, many years after first watching and loving Bladerunner, the film it inspired. <p /> It&#8217;s a wonderfully dark and deep story, far more so than the film. The vulnerability of Deckard, subsumed in the naivety and beliefs of the post-apocalyptic world he inhabits, is a far cry from the cerebral, flawed hero around which Ridley Scott&#8217;s film is centred. Philip K Dick&#8217;s androids and humans are much less binary than their cinematographic counterparts.
They are both enthralling works in their own right and if you&#8217;ve only got round to seeing Bladerunner, you should definitely make time to read the book.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/ready-to-come-home-is-sign-of-a-good-holiday">Ready to Come Home Is Sign of a Good Holiday</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-08-27T19:49:15+01:00" pubdate data-updated="true">Aug 27<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Traditionally, not wanting to come home is considered the sign of a good holiday. You never want the fun to end. <p /> However, I reckon being ready to come home is a pretty good indication that you&#8217;re refreshed, recharged and ready to take on the world again. Your holiday has done it&#8217;s job. Assuming of course you&#8217;ve had a good time.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/4/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/2/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <img src="/images/adam-avatar.jpg">
  <p>A software developer, entrepreneur and cyclists you may know from such productions as:</p>
  <ul>
    <li><a href="http://www.esendex.co.uk"><img src="/images/esendex-logo.jpg" width="40px" alt="Esendex logo" class="left"/>Esendex: international text messaging service provider</a></li>
    <li><a href="http://www.bunch.cc"><img src="/images/bunch-rides-logo.png" width="40px" alt="Bunch Rides logo" class="left"/>Bunch Rides: cycling training diary &amp; bike ride organiser</a></li>
    <li><a href="http://evenitron.com"><img src="/images/evenitron-logo.png" width="40px" alt="Evenitron logo" class="left"/>Evenitron: resque and delayed_job monitoring</a></li>
  </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/top-80s-film-your-children-must-see">Top 80s Films Your Children Must See</a>
      </li>
    
      <li class="post">
        <a href="/code-club-a-call-to-arms">Code Club, a call to arms</a>
      </li>
    
      <li class="post">
        <a href="/4-years-a-thought-experiment">4 years - a thought experiment</a>
      </li>
    
      <li class="post">
        <a href="/the-nottingham-creative-quarter-what-can-you">The Nottingham Creative Quarter - What can you do</a>
      </li>
    
      <li class="post">
        <a href="/delayedjob-syck-woes-when-deploying-to-heroku">Delayed_job Syck woes when deploying to Heroku Cedar</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/adambird">@adambird</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'adambird',
            count: 4,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("adambird", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/adambird" class="twitter-follow-button" data-show-count="false">Follow @adambird</a>
  
</section>


<section>
  <h1>My Pinboard</h1>
  <ul id="pinboard_linkroll">Fetching linkroll&#8230;</ul>
  <p><a href="http://pinboard.in/u:adambird">My Pinboard Bookmarks &raquo;</a></p>
</section>
<script type="text/javascript">
  var linkroll = 'pinboard_linkroll'; //id target for pinboard list
  var pinboard_user = "adambird"; //id target for pinboard list
  var pinboard_count = 3; //id target for pinboard list
  (function(){
    var pinboardInit = document.createElement('script');
    pinboardInit.type = 'text/javascript';
    pinboardInit.async = true;
    pinboardInit.src = '/javascripts/pinboard.js';
    document.getElementsByTagName('head')[0].appendChild(pinboardInit);
  })();
</script>


<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/104354607130956266898?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Adam -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'adambird';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
